<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #6c5ce7;
            --secondary-color: #a29bfe;
            --dark-color: #2d3436;
            --light-color: #f5f6fa;
            --success-color: #00b894;
            --danger-color: #d63031;
            --warning-color: #fdcb6e;
            --info-color: #0984e3;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
        }

        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 20px;
        }

        .login-box {
            background-color: white;
            padding: 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 400px;
            transform: translateY(0);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .login-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .login-title {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 2rem;
            font-weight: 700;
        }

        .input-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            padding-right: 2.5rem;
        }

        .input-group input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
        }

        .input-group .input-icon {
            position: absolute;
            right: 1rem;
            top: 2.5rem;
            color: var(--primary-color);
            cursor: pointer;
        }

        .login-btn {
            width: 100%;
            padding: 0.8rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1rem;
        }

        .login-btn:hover {
            background-color: #5a4bd1;
            transform: translateY(-2px);
        }

        /* Chat Page */
        .chat-container {
            display: none;
            height: 100vh;
            background-color: var(--light-color);
            flex-direction: column;
        }

        .chat-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .chat-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: white;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .chat-main {
            display: flex;
            height: calc(100vh - 64px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background-color: white;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            overflow: hidden;
        }

        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-title {
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .user-list {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .user-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 0.5rem;
        }

        .user-item:hover {
            background-color: #f0e6ff;
        }

        .user-item.active {
            background-color: #e6e0ff;
        }

        .user-item-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.75rem;
        }

        .user-item-name {
            font-weight: 500;
        }

        .user-item-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--success-color);
            margin-left: auto;
        }

        /* Chat Area */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            background-color: #f8f9fa;
        }

        .message {
            margin-bottom: 1rem;
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            position: relative;
            animation: messageIn 0.3s ease;
        }

        @keyframes messageIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .sent {
            background-color: var(--primary-color);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .received {
            background-color: white;
            color: var(--dark-color);
            margin-right: auto;
            border-bottom-left-radius: 5px;
            box-shadow: var(--shadow);
        }

        .message-sender {
            font-weight: 600;
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        .received .message-sender {
            color: var(--primary-color);
        }

        .message-content {
            word-wrap: break-word;
            font-size: 0.95rem;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.8;
            text-align: right;
            margin-top: 0.25rem;
        }

        .date-separator {
            text-align: center;
            margin: 1.5rem 0;
            position: relative;
            color: var(--dark-color);
            font-size: 0.8rem;
        }

        .date-separator::before, .date-separator::after {
            content: "";
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background-color: #ddd;
        }

        .date-separator::before {
            left: 0;
        }

        .date-separator::after {
            right: 0;
        }

        .date-separator span {
            background-color: #f8f9fa;
            padding: 0 0.75rem;
            position: relative;
            z-index: 1;
        }

        .input-area {
            padding: 1rem;
            background-color: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
        }

        .message-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            resize: none;
            height: 50px;
            max-height: 120px;
        }

        .message-input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.2);
        }

        .send-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.1rem;
        }

        .send-btn:hover {
            background-color: #5a4bd1;
            transform: scale(1.05);
        }

        .typing-indicator {
            font-size: 0.8rem;
            color: #666;
            margin-left: 1rem;
            font-style: italic;
            height: 20px;
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .login-box {
                padding: 1.5rem;
            }

            .sidebar {
                position: absolute;
                height: calc(100vh - 64px);
                z-index: 100;
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .message {
                max-width: 85%;
            }
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-container" id="loginPage">
        <div class="login-box">
            <h1 class="login-title">Neon Chat</h1>
            <div class="input-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Enter your username">
                <i class="fas fa-user input-icon"></i>
            </div>
            <div class="input-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password">
                <i class="fas fa-eye input-icon" id="togglePassword"></i>
            </div>
            <button class="login-btn" id="loginBtn">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
        </div>
    </div>
    
    <!-- Chat Page -->
    <div class="chat-container" id="chatPage">
        <div class="chat-header">
            <div class="chat-title">Neon Chat</div>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">U</div>
                <span id="currentUsername">User</span>
            </div>
        </div>
        <div class="chat-main">
            <div class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">Active Users</div>
                </div>
                <div class="user-list" id="userList">
                    <!-- Users will be populated here -->
                </div>
            </div>
            <div class="chat-area">
                <div class="messages" id="messages">
                    <div class="welcome-message">
                        <p>Welcome to Neon Chat! Select a user to start chatting.</p>
                    </div>
                </div>
                <div class="input-area">
                    <textarea class="message-input" id="messageInput" placeholder="Type a message..." disabled></textarea>
                    <div class="typing-indicator" id="typingIndicator"></div>
                    <button class="send-btn" id="sendBtn" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const loginPage = document.getElementById('loginPage');
        const chatPage = document.getElementById('chatPage');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');
        const togglePassword = document.getElementById('togglePassword');
        const loginBtn = document.getElementById('loginBtn');
        const sidebar = document.getElementById('sidebar');
        const userList = document.getElementById('userList');
        const messagesContainer = document.getElementById('messages');
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const currentUsername = document.getElementById('currentUsername');
        const userAvatar = document.getElementById('userAvatar');
        const typingIndicator = document.getElementById('typingIndicator');

        // Application State
        let currentUser = '';
        let selectedUser = null;
        let chatHistory = {};
        let typingTimeout = null;
        
        // Mock database (in a real app, this would be server-side)
        const usersDatabase = {
            'user1': { password: 'password1', name: 'User One', avatar: 'U1', online: true },
            'user2': { password: 'password2', name: 'User Two', avatar: 'U2', online: true },
            'admin': { password: 'admin123', name: 'Admin', avatar: 'AD', online: false }
        };
        
        // Initialize chat history for each user pair
        function initializeChatHistory() {
            const userPairs = [
                ['user1', 'user2'],
                ['user1', 'admin'],
                ['user2', 'admin']
            ];
            
            userPairs.forEach(pair => {
                const key = pair.sort().join('_');
                if (!chatHistory[key]) {
                    chatHistory[key] = JSON.parse(localStorage.getItem(`chat_${key}`)) || [];
                }
            });
        }
        
        // Toggle password visibility
        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            this.classList.toggle('fa-eye');
            this.classList.toggle('fa-eye-slash');
        });
        
        // Login functionality
        loginBtn.addEventListener('click', function() {
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();
            
            if (!username || !password) {
                alert('Please enter both username and password');
                return;
            }
            
            if (usersDatabase[username] && usersDatabase[username].password === password) {
                currentUser = username;
                currentUsername.textContent = usersDatabase[username].name;
                userAvatar.textContent = usersDatabase[username].avatar;
                
                // Mark user as online
                usersDatabase[username].online = true;
                
                loginPage.style.display = 'none';
                chatPage.style.display = 'flex';
                
                initializeChatHistory();
                populateUserList();
            } else {
                alert('Invalid username or password');
            }
        });
        
        // Allow login with Enter key
        passwordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loginBtn.click();
            }
        });
        
        // Populate user list
        function populateUserList() {
            userList.innerHTML = '';
            
            Object.keys(usersDatabase).forEach(username => {
                if (username !== currentUser) {
                    const user = usersDatabase[username];
                    const userItem = document.createElement('div');
                    userItem.className = 'user-item';
                    userItem.innerHTML = `
                        <div class="user-item-avatar">${user.avatar}</div>
                        <div class="user-item-name">${user.name}</div>
                        <div class="user-item-status ${user.online ? 'online' : 'offline'}"></div>
                    `;
                    
                    userItem.addEventListener('click', () => {
                        // Remove active class from all users
                        document.querySelectorAll('.user-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        
                        // Add active class to selected user
                        userItem.classList.add('active');
                        
                        // Set selected user
                        selectedUser = username;
                        
                        // Enable message input
                        messageInput.disabled = false;
                        sendBtn.disabled = false;
                        
                        // Load chat history
                        loadChatHistory(currentUser, selectedUser);
                    });
                    
                    userList.appendChild(userItem);
                }
            });
        }
        
        // Get chat key for two users
        function getChatKey(user1, user2) {
            return [user1, user2].sort().join('_');
        }
        
        // Load chat history between two users
        function loadChatHistory(user1, user2) {
            const key = getChatKey(user1, user2);
            const history = chatHistory[key] || [];
            
            messagesContainer.innerHTML = '';
            
            if (history.length === 0) {
                const welcomeMsg = document.createElement('div');
                welcomeMsg.className = 'welcome-message';
                welcomeMsg.innerHTML = `<p>Start a new conversation with ${usersDatabase[user2].name}!</p>`;
                messagesContainer.appendChild(welcomeMsg);
                return;
            }
            
            let lastMessageDate = null;
            
            history.forEach(message => {
                displayMessage(message, user1);
            });
            
            // Scroll to bottom
            setTimeout(() => {
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 100);
        }
        
        // Display a message
        function displayMessage(message, currentUser) {
            const messageDate = new Date(message.timestamp);
            const now = new Date();
            
            // Create message element
            const messageElement = document.createElement('div');
            messageElement.className = `message ${message.sender === currentUser ? 'sent' : 'received'}`;
            
            // Format time
            const timeString = messageDate.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            }).toLowerCase();
            
            messageElement.innerHTML = `
                <div class="message-sender">${usersDatabase[message.sender].name}</div>
                <div class="message-content">${message.text}</div>
                <div class="message-time">${timeString}</div>
            `;
            
            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // Send message
        function sendMessage() {
            const messageText = messageInput.value.trim();
            if (!messageText || !selectedUser) return;
            
            const now = new Date();
            const message = {
                sender: currentUser,
                text: messageText,
                timestamp: now.getTime(),
                date: now.toLocaleDateString()
            };
            
            // Save message to chat history
            const key = getChatKey(currentUser, selectedUser);
            chatHistory[key].push(message);
            localStorage.setItem(`chat_${key}`, JSON.stringify(chatHistory[key]));
            
            // Display message
            displayMessage(message, currentUser);
            
            // Clear input
            messageInput.value = '';
            
            // Simulate received message after a delay
            if (Math.random() > 0.3) { // 70% chance of reply
                setTimeout(() => {
                    simulateReply(selectedUser, currentUser);
                }, 1000 + Math.random() * 3000);
            }
        }
        
        // Simulate a reply from the other user
        function simulateReply(sender, receiver) {
            const replies = [
                "Hey there!",
                "How are you doing?",
                "That's interesting!",
                "I was thinking the same thing!",
                "Let's meet up soon.",
                "Thanks for letting me know.",
                "I'll get back to you on that.",
                "Sounds good to me!",
                "What are your plans for the weekend?",
                "Did you see the latest news?"
            ];
            
            const now = new Date();
            const message = {
                sender: sender,
                text: replies[Math.floor(Math.random() * replies.length)],
                timestamp: now.getTime(),
                date: now.toLocaleDateString()
            };
            
            // Save message to chat history
            const key = getChatKey(currentUser, selectedUser);
            chatHistory[key].push(message);
            localStorage.setItem(`chat_${key}`, JSON.stringify(chatHistory[key]));
            
            // Only display if this is the active chat
            if (selectedUser === sender) {
                displayMessage(message, currentUser);
                
                // Show typing indicator
                typingIndicator.textContent = `${usersDatabase[sender].name} is typing...`;
                
                // Hide typing indicator after delay
                setTimeout(() => {
                    typingIndicator.textContent = '';
                }, 2000);
            }
        }
        
        // Send message on button click or Enter key (without shift)
        sendBtn.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // Typing indicator
        messageInput.addEventListener('input', function() {
            if (typingTimeout) clearTimeout(typingTimeout);
            
            // Show typing indicator to other user (simulated)
            if (this.value.length > 0) {
                // In a real app, you would send a "typing" event to the server
            }
            
            typingTimeout = setTimeout(() => {
                // Hide typing indicator after 1 second of inactivity
                // In a real app, you would send a "stopped typing" event
            }, 1000);
        });
        
        // Responsive sidebar toggle
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('open');
            } else {
                sidebar.classList.add('open');
            }
        });
        
        // Initialize for mobile
        if (window.innerWidth <= 768) {
            sidebar.classList.remove('open');
        } else {
            sidebar.classList.add('open');
        }
    </script>
</body>
</html>
